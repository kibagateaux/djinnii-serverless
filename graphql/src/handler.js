Object.defineProperty(exports,"__esModule",{value:true});exports.GraphQLServer=undefined;var _express=require('express');var _express2=_interopRequireDefault(_express);var _awsServerlessExpress=require('aws-serverless-express');var _awsServerlessExpress2=_interopRequireDefault(_awsServerlessExpress);var _middleware=require('aws-serverless-express/middleware');var _middleware2=_interopRequireDefault(_middleware);var _graphqlServerExpress=require('graphql-server-express');var _neo4jDriver=require('neo4j-driver');var _bodyParser=require('body-parser');var _bodyParser2=_interopRequireDefault(_bodyParser);var _schema=require('./schema');var _schema2=_interopRequireDefault(_schema);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function context(headers,secrets,event){var driver=_neo4jDriver.v1.driver(secrets.NEO4J_URI||"bolt://localhost:7687",_neo4jDriver.v1.auth.basic(secrets.NEO4J_USER||"neo4j",secrets.NEO4J_PASSWORD||"kiba"));return{driver:driver,headers:headers,event:event};}var rootValue={};var PORT=8081;var app=(0,_express2.default)();app.use(_middleware2.default.eventContext());app.use('/',_bodyParser2.default.json(),(0,_graphqlServerExpress.graphqlExpress)(function(request){return{schema:_schema2.default,rootValue:rootValue,context:context(request.headers,process.env,request.apiGateway.event)};}));app.use('/graphiql',(0,_graphqlServerExpress.graphiqlExpress)({endpointURL:'/',query:'{\n    \n  }'}));app.listen(PORT,function(){console.log('GraphQL Server is now running on http://localhost:'+PORT+'/');console.log('View GraphiQL at http://localhost:'+PORT+'/graphiql');});var server=_awsServerlessExpress2.default.createServer(app);var GraphQLServer=exports.GraphQLServer=function GraphQLServer(event,context){return _awsServerlessExpress2.default.proxy(server,event,context);};